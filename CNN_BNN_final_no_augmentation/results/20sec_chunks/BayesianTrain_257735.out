Using device: cuda
Output directory: results/20sec_chunks
Loading data...
Found 5094 samples with shape torch.Size([1025, 938]) and 3 classes
Initializing model...
Starting training...

Epoch 1 Summary:
Time: 45.04s | Total: 0m 45s
LR: 1.00e-04 | Train Loss: 3.4386 | Val Loss: 1.1053
KL Loss: 154387.2885 | Train Acc: 73.07% | Val Acc: 81.41%
Saved best model at epoch 1 with val loss: 1.1053

Epoch 2 Summary:
Time: 37.55s | Total: 1m 25s
LR: 1.00e-04 | Train Loss: 0.7030 | Val Loss: 0.4145
KL Loss: 59109.1333 | Train Acc: 81.96% | Val Acc: 85.60%
Saved best model at epoch 2 with val loss: 0.4145

Epoch 3 Summary:
Time: 37.49s | Total: 2m 6s
LR: 1.00e-04 | Train Loss: 0.4383 | Val Loss: 0.3693
KL Loss: 33015.6068 | Train Acc: 84.07% | Val Acc: 88.22%
Saved best model at epoch 3 with val loss: 0.3693

Epoch 4 Summary:
Time: 37.43s | Total: 2m 46s
LR: 1.00e-04 | Train Loss: 0.3852 | Val Loss: 0.3508
KL Loss: 21423.1196 | Train Acc: 86.56% | Val Acc: 89.14%
Saved best model at epoch 4 with val loss: 0.3508

Epoch 5 Summary:
Time: 37.41s | Total: 3m 27s
LR: 1.00e-04 | Train Loss: 0.3522 | Val Loss: 0.3504
KL Loss: 15097.4811 | Train Acc: 87.29% | Val Acc: 86.65%
Saved best model at epoch 5 with val loss: 0.3504

Epoch 6 Summary:
Time: 37.89s | Total: 4m 8s
LR: 1.00e-04 | Train Loss: 0.3227 | Val Loss: 0.3253
KL Loss: 11215.1208 | Train Acc: 87.91% | Val Acc: 88.61%
Saved best model at epoch 6 with val loss: 0.3253

Epoch 7 Summary:
Time: 37.47s | Total: 4m 48s
LR: 1.00e-04 | Train Loss: 0.2845 | Val Loss: 0.2972
KL Loss: 8642.0321 | Train Acc: 89.59% | Val Acc: 89.40%
Saved best model at epoch 7 with val loss: 0.2972

Epoch 8 Summary:
Time: 37.45s | Total: 5m 29s
LR: 1.00e-04 | Train Loss: 0.2696 | Val Loss: 0.3360
KL Loss: 6841.3997 | Train Acc: 90.15% | Val Acc: 87.43%

Epoch 9 Summary:
Time: 37.49s | Total: 6m 6s
LR: 1.00e-04 | Train Loss: 0.2451 | Val Loss: 0.2862
KL Loss: 5529.0554 | Train Acc: 90.94% | Val Acc: 90.18%
Saved best model at epoch 9 with val loss: 0.2862

Epoch 10 Summary:
Time: 37.47s | Total: 6m 47s
LR: 1.00e-04 | Train Loss: 0.2270 | Val Loss: 0.3380
KL Loss: 4542.2190 | Train Acc: 91.58% | Val Acc: 88.09%

Epoch 11 Summary:
Time: 37.49s | Total: 7m 24s
LR: 1.00e-04 | Train Loss: 0.2212 | Val Loss: 0.3126
KL Loss: 4144.7835 | Train Acc: 91.92% | Val Acc: 87.43%

Epoch 12 Summary:
Time: 37.59s | Total: 8m 2s
LR: 1.00e-04 | Train Loss: 0.2082 | Val Loss: 0.2915
KL Loss: 3761.0702 | Train Acc: 92.48% | Val Acc: 90.18%

Epoch 13 Summary:
Time: 37.55s | Total: 8m 40s
LR: 1.00e-04 | Train Loss: 0.1760 | Val Loss: 0.2902
KL Loss: 3394.4127 | Train Acc: 93.69% | Val Acc: 90.97%

Epoch 14 Summary:
Time: 37.55s | Total: 9m 17s
LR: 1.00e-04 | Train Loss: 0.1692 | Val Loss: 0.3245
KL Loss: 3047.8511 | Train Acc: 93.60% | Val Acc: 90.45%

Epoch 15 Summary:
Time: 37.55s | Total: 9m 55s
LR: 1.00e-04 | Train Loss: 0.1348 | Val Loss: 0.2860
KL Loss: 2723.6445 | Train Acc: 95.43% | Val Acc: 89.92%
Saved best model at epoch 15 with val loss: 0.2860

Epoch 16 Summary:
Time: 37.45s | Total: 10m 35s
LR: 1.00e-04 | Train Loss: 0.1311 | Val Loss: 0.2953
KL Loss: 2423.2701 | Train Acc: 95.32% | Val Acc: 89.79%

Epoch 17 Summary:
Time: 37.38s | Total: 11m 13s
LR: 1.00e-04 | Train Loss: 0.1294 | Val Loss: 0.2998
KL Loss: 2147.6673 | Train Acc: 95.37% | Val Acc: 90.05%

Epoch 18 Summary:
Time: 37.49s | Total: 11m 50s
LR: 1.00e-04 | Train Loss: 0.1154 | Val Loss: 0.3303
KL Loss: 1897.2193 | Train Acc: 95.93% | Val Acc: 89.66%

Epoch 19 Summary:
Time: 37.58s | Total: 12m 28s
LR: 1.00e-04 | Train Loss: 0.1081 | Val Loss: 0.3265
KL Loss: 1671.8468 | Train Acc: 96.58% | Val Acc: 90.05%

Epoch 20 Summary:
Time: 37.47s | Total: 13m 5s
LR: 1.00e-04 | Train Loss: 0.1077 | Val Loss: 0.3088
KL Loss: 1470.8762 | Train Acc: 96.33% | Val Acc: 90.05%

Epoch 21 Summary:
Time: 37.37s | Total: 13m 43s
LR: 1.00e-04 | Train Loss: 0.0886 | Val Loss: 0.3039
KL Loss: 1293.3856 | Train Acc: 97.48% | Val Acc: 90.05%

Epoch 22 Summary:
Time: 37.48s | Total: 14m 20s
LR: 5.00e-05 | Train Loss: 0.0772 | Val Loss: 0.2975
KL Loss: 1173.7449 | Train Acc: 97.59% | Val Acc: 91.62%

Epoch 23 Summary:
Time: 37.43s | Total: 14m 57s
LR: 5.00e-05 | Train Loss: 0.0689 | Val Loss: 0.3154
KL Loss: 1099.7929 | Train Acc: 98.32% | Val Acc: 91.62%

Epoch 24 Summary:
Time: 37.53s | Total: 15m 35s
LR: 5.00e-05 | Train Loss: 0.0701 | Val Loss: 0.3209
KL Loss: 1029.3561 | Train Acc: 97.95% | Val Acc: 90.31%

Epoch 25 Summary:
Time: 37.48s | Total: 16m 13s
LR: 5.00e-05 | Train Loss: 0.0701 | Val Loss: 0.3173
KL Loss: 962.6875 | Train Acc: 98.20% | Val Acc: 90.18%

Epoch 26 Summary:
Time: 37.44s | Total: 16m 50s
LR: 5.00e-05 | Train Loss: 0.0685 | Val Loss: 0.3128
KL Loss: 899.9923 | Train Acc: 98.32% | Val Acc: 90.71%

Epoch 27 Summary:
Time: 37.47s | Total: 17m 27s
LR: 5.00e-05 | Train Loss: 0.0642 | Val Loss: 0.2977
KL Loss: 841.3590 | Train Acc: 98.65% | Val Acc: 91.10%

Epoch 28 Summary:
Time: 37.37s | Total: 18m 5s
LR: 2.50e-05 | Train Loss: 0.0628 | Val Loss: 0.3055
KL Loss: 799.8014 | Train Acc: 98.63% | Val Acc: 91.36%

Epoch 29 Summary:
Time: 37.46s | Total: 18m 42s
LR: 2.50e-05 | Train Loss: 0.0650 | Val Loss: 0.3164
KL Loss: 773.0156 | Train Acc: 98.29% | Val Acc: 90.71%

Epoch 30 Summary:
Time: 37.61s | Total: 19m 20s
LR: 2.50e-05 | Train Loss: 0.0626 | Val Loss: 0.3015
KL Loss: 746.6440 | Train Acc: 98.15% | Val Acc: 91.23%

Early stopping at epoch 30 after 15 epochs without improvement
Best validation loss: 0.2860 | Best accuracy: 89.92%

Training completed in 19m 20s
Best validation loss: 0.2860 | Best accuracy: 89.92%
