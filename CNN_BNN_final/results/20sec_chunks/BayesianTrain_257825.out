Using device: cuda
Output directory: results/20sec_chunks
Loading data...
Found 5094 samples with shape torch.Size([1025, 938]) and 3 classes
Initializing model...
Starting training...

Epoch 1 Summary:
Time: 44.27s | Total: 0m 44s
LR: 1.00e-04 | Train Loss: 2.4399 | Val Loss: 0.4606
KL Loss: 264921.1450 | Train Acc: 76.33% | Val Acc: 85.86%
Saved best model at epoch 1 with val loss: 0.4606

Epoch 2 Summary:
Time: 39.87s | Total: 1m 27s
LR: 1.00e-04 | Train Loss: 0.5045 | Val Loss: 0.3721
KL Loss: 78116.1229 | Train Acc: 81.82% | Val Acc: 88.09%
Saved best model at epoch 2 with val loss: 0.3721

Epoch 3 Summary:
Time: 39.85s | Total: 2m 10s
LR: 1.00e-04 | Train Loss: 0.4168 | Val Loss: 0.3561
KL Loss: 36583.6906 | Train Acc: 84.52% | Val Acc: 88.22%
Saved best model at epoch 3 with val loss: 0.3561

Epoch 4 Summary:
Time: 39.88s | Total: 2m 53s
LR: 1.00e-04 | Train Loss: 0.3676 | Val Loss: 0.3297
KL Loss: 20476.6158 | Train Acc: 86.51% | Val Acc: 88.74%
Saved best model at epoch 4 with val loss: 0.3297

Epoch 5 Summary:
Time: 39.91s | Total: 3m 36s
LR: 1.00e-04 | Train Loss: 0.3489 | Val Loss: 0.3175
KL Loss: 12659.1321 | Train Acc: 87.35% | Val Acc: 89.01%
Saved best model at epoch 5 with val loss: 0.3175

Epoch 6 Summary:
Time: 39.93s | Total: 4m 19s
LR: 1.00e-04 | Train Loss: 0.3162 | Val Loss: 0.3295
KL Loss: 8349.6209 | Train Acc: 87.99% | Val Acc: 89.92%

Epoch 7 Summary:
Time: 39.91s | Total: 4m 59s
LR: 1.00e-04 | Train Loss: 0.2813 | Val Loss: 0.2942
KL Loss: 5769.3325 | Train Acc: 89.59% | Val Acc: 89.27%
Saved best model at epoch 7 with val loss: 0.2942

Epoch 8 Summary:
Time: 39.88s | Total: 5m 42s
LR: 1.00e-04 | Train Loss: 0.2585 | Val Loss: 0.2844
KL Loss: 4132.8025 | Train Acc: 90.18% | Val Acc: 90.45%
Saved best model at epoch 8 with val loss: 0.2844

Epoch 9 Summary:
Time: 39.95s | Total: 6m 25s
LR: 1.00e-04 | Train Loss: 0.2422 | Val Loss: 0.2866
KL Loss: 3049.3500 | Train Acc: 90.66% | Val Acc: 90.71%

Epoch 10 Summary:
Time: 39.95s | Total: 7m 5s
LR: 1.00e-04 | Train Loss: 0.2232 | Val Loss: 0.3062
KL Loss: 2308.3717 | Train Acc: 91.53% | Val Acc: 90.31%

Epoch 11 Summary:
Time: 39.89s | Total: 7m 45s
LR: 1.00e-04 | Train Loss: 0.1946 | Val Loss: 0.2948
KL Loss: 1954.2580 | Train Acc: 92.82% | Val Acc: 90.18%

Epoch 12 Summary:
Time: 39.91s | Total: 8m 25s
LR: 1.00e-04 | Train Loss: 0.1817 | Val Loss: 0.2992
KL Loss: 1656.4833 | Train Acc: 92.90% | Val Acc: 89.92%

Epoch 13 Summary:
Time: 39.92s | Total: 9m 4s
LR: 1.00e-04 | Train Loss: 0.1699 | Val Loss: 0.2841
KL Loss: 1413.3830 | Train Acc: 93.32% | Val Acc: 90.97%
Saved best model at epoch 13 with val loss: 0.2841

Epoch 14 Summary:
Time: 40.05s | Total: 9m 48s
LR: 1.00e-04 | Train Loss: 0.1467 | Val Loss: 0.2927
KL Loss: 1221.4567 | Train Acc: 94.84% | Val Acc: 90.31%

Epoch 15 Summary:
Time: 39.91s | Total: 10m 27s
LR: 1.00e-04 | Train Loss: 0.1350 | Val Loss: 0.2954
KL Loss: 1073.3396 | Train Acc: 95.15% | Val Acc: 89.79%

Epoch 16 Summary:
Time: 39.90s | Total: 11m 7s
LR: 1.00e-04 | Train Loss: 0.1195 | Val Loss: 0.3467
KL Loss: 961.7959 | Train Acc: 95.85% | Val Acc: 88.48%

Epoch 17 Summary:
Time: 39.93s | Total: 11m 47s
LR: 1.00e-04 | Train Loss: 0.1148 | Val Loss: 0.2834
KL Loss: 878.7944 | Train Acc: 96.13% | Val Acc: 90.97%
Saved best model at epoch 17 with val loss: 0.2834

Epoch 18 Summary:
Time: 39.95s | Total: 12m 30s
LR: 1.00e-04 | Train Loss: 0.1104 | Val Loss: 0.3128
KL Loss: 817.0413 | Train Acc: 96.27% | Val Acc: 90.05%

Epoch 19 Summary:
Time: 39.93s | Total: 13m 10s
LR: 1.00e-04 | Train Loss: 0.0929 | Val Loss: 0.3039
KL Loss: 769.7947 | Train Acc: 97.08% | Val Acc: 89.27%

Epoch 20 Summary:
Time: 39.94s | Total: 13m 50s
LR: 1.00e-04 | Train Loss: 0.1053 | Val Loss: 0.3371
KL Loss: 732.0877 | Train Acc: 96.49% | Val Acc: 89.27%

Epoch 21 Summary:
Time: 39.91s | Total: 14m 30s
LR: 1.00e-04 | Train Loss: 0.0781 | Val Loss: 0.3495
KL Loss: 699.9980 | Train Acc: 97.78% | Val Acc: 89.66%

Epoch 22 Summary:
Time: 39.95s | Total: 15m 10s
LR: 1.00e-04 | Train Loss: 0.0833 | Val Loss: 0.3175
KL Loss: 670.9677 | Train Acc: 97.62% | Val Acc: 90.71%

Epoch 23 Summary:
Time: 39.92s | Total: 15m 50s
LR: 1.00e-04 | Train Loss: 0.0825 | Val Loss: 0.2983
KL Loss: 644.1162 | Train Acc: 97.78% | Val Acc: 90.45%

Epoch 24 Summary:
Time: 39.95s | Total: 16m 30s
LR: 5.00e-05 | Train Loss: 0.0726 | Val Loss: 0.3165
KL Loss: 624.0249 | Train Acc: 97.48% | Val Acc: 90.31%

Epoch 25 Summary:
Time: 39.99s | Total: 17m 10s
LR: 5.00e-05 | Train Loss: 0.0627 | Val Loss: 0.3247
KL Loss: 610.7126 | Train Acc: 98.09% | Val Acc: 90.84%

Epoch 26 Summary:
Time: 39.94s | Total: 17m 50s
LR: 5.00e-05 | Train Loss: 0.0642 | Val Loss: 0.3286
KL Loss: 597.6188 | Train Acc: 98.09% | Val Acc: 90.84%

Epoch 27 Summary:
Time: 39.92s | Total: 18m 30s
LR: 5.00e-05 | Train Loss: 0.0565 | Val Loss: 0.3214
KL Loss: 584.0337 | Train Acc: 98.32% | Val Acc: 90.45%

Epoch 28 Summary:
Time: 39.93s | Total: 19m 10s
LR: 5.00e-05 | Train Loss: 0.0621 | Val Loss: 0.3332
KL Loss: 570.5461 | Train Acc: 98.15% | Val Acc: 90.71%

Epoch 29 Summary:
Time: 39.97s | Total: 19m 50s
LR: 5.00e-05 | Train Loss: 0.0557 | Val Loss: 0.3400
KL Loss: 557.2070 | Train Acc: 98.32% | Val Acc: 90.97%

Epoch 30 Summary:
Time: 39.89s | Total: 20m 30s
LR: 2.50e-05 | Train Loss: 0.0526 | Val Loss: 0.3360
KL Loss: 547.0954 | Train Acc: 98.37% | Val Acc: 91.49%

Epoch 31 Summary:
Time: 39.95s | Total: 21m 10s
LR: 2.50e-05 | Train Loss: 0.0527 | Val Loss: 0.3361
KL Loss: 540.2699 | Train Acc: 98.35% | Val Acc: 90.97%

Epoch 32 Summary:
Time: 39.94s | Total: 21m 49s
LR: 2.50e-05 | Train Loss: 0.0545 | Val Loss: 0.3549
KL Loss: 533.4636 | Train Acc: 98.23% | Val Acc: 90.58%

Early stopping at epoch 32 after 15 epochs without improvement
Best validation loss: 0.2834 | Best accuracy: 90.97%

Training completed in 21m 49s
Best validation loss: 0.2834 | Best accuracy: 90.97%
