Using device: cuda
Output directory: results/run_20250731_165221
Loading data...
Found 5094 samples with shape torch.Size([1025, 938]) and 3 classes
Initializing model...
Starting training...

Epoch 1 Summary:
Time: 42.59s | Total: 0m 43s
LR: 1.00e-04 | Train Loss: 3.4066 | Val Loss: 1.1156
KL Loss: 58910.1789 | Train Acc: 75.65% | Val Acc: 82.07%
Saved best model at epoch 1 with val loss: 1.1156

Epoch 2 Summary:
Time: 39.10s | Total: 1m 25s
LR: 1.00e-04 | Train Loss: 0.6265 | Val Loss: 0.4941
KL Loss: 28945.4854 | Train Acc: 79.94% | Val Acc: 83.25%
Saved best model at epoch 2 with val loss: 0.4941

Epoch 3 Summary:
Time: 39.12s | Total: 2m 10s
LR: 1.00e-04 | Train Loss: 0.4670 | Val Loss: 0.5549
KL Loss: 19112.2466 | Train Acc: 83.00% | Val Acc: 84.29%

Epoch 4 Summary:
Time: 39.12s | Total: 2m 50s
LR: 1.00e-04 | Train Loss: 0.4627 | Val Loss: 0.4090
KL Loss: 14232.1814 | Train Acc: 81.63% | Val Acc: 86.39%
Saved best model at epoch 4 with val loss: 0.4090

Epoch 5 Summary:
Time: 39.16s | Total: 3m 34s
LR: 1.00e-04 | Train Loss: 0.4254 | Val Loss: 0.4323
KL Loss: 11319.2094 | Train Acc: 82.97% | Val Acc: 86.26%

Epoch 6 Summary:
Time: 39.20s | Total: 4m 13s
LR: 1.00e-04 | Train Loss: 0.3555 | Val Loss: 0.3562
KL Loss: 9384.6984 | Train Acc: 85.78% | Val Acc: 86.91%
Saved best model at epoch 6 with val loss: 0.3562

Epoch 7 Summary:
Time: 39.17s | Total: 4m 58s
LR: 1.00e-04 | Train Loss: 0.4075 | Val Loss: 0.4424
KL Loss: 8006.9951 | Train Acc: 82.05% | Val Acc: 86.13%

Epoch 8 Summary:
Time: 39.17s | Total: 5m 37s
LR: 1.00e-04 | Train Loss: 0.3613 | Val Loss: 0.4278
KL Loss: 6976.1413 | Train Acc: 88.16% | Val Acc: 86.91%

Epoch 9 Summary:
Time: 39.12s | Total: 6m 17s
LR: 1.00e-04 | Train Loss: 0.3410 | Val Loss: 0.4482
KL Loss: 6175.8003 | Train Acc: 88.72% | Val Acc: 87.57%

Epoch 10 Summary:
Time: 39.13s | Total: 6m 56s
LR: 1.00e-04 | Train Loss: 0.3284 | Val Loss: 0.3449
KL Loss: 5536.3724 | Train Acc: 88.47% | Val Acc: 87.17%
Saved best model at epoch 10 with val loss: 0.3449

Epoch 11 Summary:
Time: 39.18s | Total: 7m 40s
LR: 1.00e-04 | Train Loss: 0.3023 | Val Loss: 0.3472
KL Loss: 5514.1022 | Train Acc: 89.82% | Val Acc: 87.96%

Epoch 12 Summary:
Time: 39.17s | Total: 8m 19s
LR: 1.00e-04 | Train Loss: 0.3045 | Val Loss: 0.3780
KL Loss: 5490.1501 | Train Acc: 90.55% | Val Acc: 87.83%

Epoch 13 Summary:
Time: 39.14s | Total: 8m 59s
LR: 1.00e-04 | Train Loss: 0.2728 | Val Loss: 0.4611
KL Loss: 5464.4320 | Train Acc: 90.46% | Val Acc: 87.30%

Epoch 14 Summary:
Time: 39.16s | Total: 9m 38s
LR: 1.00e-04 | Train Loss: 0.2945 | Val Loss: 0.4696
KL Loss: 5436.8999 | Train Acc: 89.76% | Val Acc: 85.73%

Epoch 15 Summary:
Time: 39.14s | Total: 10m 17s
LR: 1.00e-04 | Train Loss: 0.2848 | Val Loss: 0.3477
KL Loss: 5407.5380 | Train Acc: 89.12% | Val Acc: 88.61%

Epoch 16 Summary:
Time: 39.16s | Total: 10m 56s
LR: 1.00e-04 | Train Loss: 0.2576 | Val Loss: 0.4070
KL Loss: 5376.3317 | Train Acc: 91.33% | Val Acc: 87.17%

Epoch 17 Summary:
Time: 39.17s | Total: 11m 35s
LR: 5.00e-05 | Train Loss: 0.2184 | Val Loss: 0.3571
KL Loss: 5351.6369 | Train Acc: 92.34% | Val Acc: 87.83%

Epoch 18 Summary:
Time: 39.13s | Total: 12m 14s
LR: 5.00e-05 | Train Loss: 0.2047 | Val Loss: 0.4601
KL Loss: 5334.0990 | Train Acc: 93.10% | Val Acc: 88.22%

Epoch 19 Summary:
Time: 39.17s | Total: 12m 54s
LR: 5.00e-05 | Train Loss: 0.1882 | Val Loss: 0.5649
KL Loss: 5315.5817 | Train Acc: 93.44% | Val Acc: 88.09%

Epoch 20 Summary:
Time: 39.16s | Total: 13m 33s
LR: 5.00e-05 | Train Loss: 0.2001 | Val Loss: 0.5353
KL Loss: 5296.1308 | Train Acc: 93.21% | Val Acc: 87.83%

Epoch 21 Summary:
Time: 39.18s | Total: 14m 12s
LR: 5.00e-05 | Train Loss: 0.1882 | Val Loss: 0.4291
KL Loss: 5275.8431 | Train Acc: 93.97% | Val Acc: 87.17%

Epoch 22 Summary:
Time: 39.13s | Total: 14m 51s
LR: 5.00e-05 | Train Loss: 0.1786 | Val Loss: 0.6418
KL Loss: 5254.7697 | Train Acc: 94.08% | Val Acc: 86.52%

Epoch 23 Summary:
Time: 39.11s | Total: 15m 30s
LR: 2.50e-05 | Train Loss: 0.1574 | Val Loss: 0.6500
KL Loss: 5238.4517 | Train Acc: 94.95% | Val Acc: 88.74%

Epoch 24 Summary:
Time: 39.18s | Total: 16m 9s
LR: 2.50e-05 | Train Loss: 0.1517 | Val Loss: 0.4945
KL Loss: 5227.1883 | Train Acc: 95.43% | Val Acc: 88.61%

Epoch 25 Summary:
Time: 39.18s | Total: 16m 48s
LR: 2.50e-05 | Train Loss: 0.1265 | Val Loss: 0.6773
KL Loss: 5215.5561 | Train Acc: 95.43% | Val Acc: 88.09%

Early stopping at epoch 25 after 15 epochs without improvement
Best validation loss: 0.3449 | Best accuracy: 87.17%

Training completed in 16m 48s
Best validation loss: 0.3449 | Best accuracy: 87.17%
